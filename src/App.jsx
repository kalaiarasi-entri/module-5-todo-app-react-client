import React,{useState,useEffect} from 'react'; import { BrowserRouter,Routes,Route,Link,Navigate,useNavigate } from 'react-router-dom'; import Home from './pages/Home'; import Login from './pages/Login'; import Register from './pages/Register'; import TasksPage from './pages/TasksPage'; import { isLogged, logout } from './utils/auth'; function Private({children}){ if(!isLogged()) return <Navigate to='/login' replace/>; return children; } function Navbar(){ const logged=isLogged(); const navigate=useNavigate(); const handleLogout=()=>{ logout(); navigate('/login'); }; return (<header className='flex items-center justify-between mb-8 container'><div className='flex-1 flex justify-center'><div className='text-center'><div className='text-2xl font-bold'>Todo</div><div className='text-sm small'>Personal Task Manager</div></div></div><nav className='flex items-center gap-2'><Link to='/' className='nav-link'>Home</Link>{logged && <Link to='/tasks' className='nav-link'>Tasks</Link>}{!logged? (<><Link to='/login' className='nav-link'>Login</Link><Link to='/register' className='nav-link'>Register</Link></>):(<button onClick={handleLogout} className='px-3 py-1 bg-red-600 text-white rounded'>Logout</button>)}</nav></header>); } export default function App(){ const [authVersion,setAuthVersion]=useState(0); useEffect(()=>{ const h=()=>setAuthVersion(v=>v+1); window.addEventListener('authChange',h); return ()=>window.removeEventListener('authChange',h); },[]); return (<BrowserRouter><Navbar key={authVersion}/><main className='container'><Routes><Route path='/' element={<Home/>}/><Route path='/login' element={<Login/>}/><Route path='/register' element={<Register/>}/><Route path='/tasks' element={<Private><TasksPage/></Private>} /></Routes></main></BrowserRouter>); }
